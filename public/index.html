<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>üöö –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç–∞–≤–∫–∞–º–∏</title>
    <link rel="stylesheet" href="styles.css?v=24">
</head>
<body>
    <div class="container">
        <header>
            <a href="/readme" class="docs-link">üìö</a>
            <h1>üöö –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç–∞–≤–∫–∞–º–∏ <span id="release-time" class="release-time"></span></h1>
            <p>–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –¥–æ—Å—Ç–∞–≤–∫–∏, –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –º–∞—Ä—à—Ä—É—Ç—ã –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —Å—Ç–∞—Ç—É—Å—ã</p>
        </header>

        <main>
            <div class="controls-wrapper">
                <div class="main-controls">
                    <button id="add-delivery-btn" class="btn btn-primary">‚ûï –î–æ–±–∞–≤–∏—Ç—å –¥–æ—Å—Ç–∞–≤–∫—É</button>
                    <button id="optimize-route-btn" class="btn btn-success" disabled>üó∫Ô∏è –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç</button>
                    <button id="delete-deliveries-btn" class="btn btn-danger" disabled>ÔøΩÔøΩÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                </div>
                <div class="selection-info">
                    <span id="selected-count">–í—ã–±—Ä–∞–Ω–æ: 0 –¥–æ—Å—Ç–∞–≤–æ–∫</span>
                </div>
            </div>

            <div class="table-container">
                <table id="deliveries-table" class="deliveries-table">
                    <thead>
                        <tr>
                            <th>
                                <input type="checkbox" id="select-all">
                            </th>
                            <th>‚Ññ –î–æ—Å—Ç–∞–≤–∫–∏</th>
                            <th>–ê–¥—Ä–µ—Å</th>
                            <th>–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>–û–±—ä–µ–º (–º¬≥)</th>
                            <th>–ù–∞ —Ç–æ—á–∫–µ (–º–∏–Ω)</th>
                            <th>–î–∞—Ç–∞</th>
                            <th>‚Ññ –ú–∞—Ä—à—Ä—É—Ç–∞</th>
                        </tr>
                    </thead>
                    <tbody id="deliveries-tbody">
                        <!-- –°—Ç—Ä–æ–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </tbody>
                </table>
            </div>

            <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç–∞–≤–∫–∏ -->
            <div id="delivery-modal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –¥–æ—Å—Ç–∞–≤–∫—É</h3>
                        <span class="close">&times;</span>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="delivery-address">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏:</label>
                            <input type="text" id="delivery-address" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ú–æ—Å–∫–≤–∞, —É–ª. –¢–≤–µ—Ä—Å–∫–∞—è, 1">
                            <div id="address-coordinates" class="coordinates-display"></div>
                            <div id="address-error" class="error-message"></div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="delivery-volume">–û–±—ä–µ–º (–º¬≥):</label>
                                <input type="number" id="delivery-volume" step="0.1" min="0" value="1.0">
                            </div>
                            <div class="form-group">
                                <label for="delivery-time">–í—Ä–µ–º—è –Ω–∞ —Ç–æ—á–∫–µ (–º–∏–Ω):</label>
                                <input type="number" id="delivery-time" min="1" value="15">
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button id="cancel-delivery" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                        <button id="save-delivery" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    </div>
                </div>
            </div>

            <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–∞—Ä—à—Ä—É—Ç–∞ -->
            <div id="route-modal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>üó∫Ô∏è –ú–∞—Ä—à—Ä—É—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω</h3>
                        <span class="close">&times;</span>
                    </div>
                    <div class="modal-body">
                        <div id="route-info">
                            <div class="route-summary">
                                <div class="summary-item">
                                    <span class="label">–ù–æ–º–µ—Ä –º–∞—Ä—à—Ä—É—Ç–∞:</span>
                                    <span id="route-number" class="value"></span>
                                </div>
                                <div class="summary-item">
                                    <span class="label">–î–æ—Å—Ç–∞–≤–æ–∫ –≤ –º–∞—Ä—à—Ä—É—Ç–µ:</span>
                                    <span id="deliveries-count" class="value"></span>
                                </div>
                                <div class="summary-item">
                                    <span class="label">–û–±—â–µ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ:</span>
                                    <span id="total-distance" class="value"></span>
                                </div>
                                <div class="summary-item">
                                    <span class="label">–û–±—â–µ–µ –≤—Ä–µ–º—è:</span>
                                    <span id="total-duration" class="value"></span>
                                </div>
                            </div>
                            
                            <div class="route-steps">
                                <h4>–ü–æ—Ä—è–¥–æ–∫ –¥–æ—Å—Ç–∞–≤–æ–∫:</h4>
                                <div id="route-steps-list" class="route-steps"></div>
                            </div>
                            
                            <div id="route-error" class="error-message"></div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button id="open-yandex-maps" class="btn btn-secondary">üó∫Ô∏è –û—Ç–∫—Ä—ã—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ</button>
                        <button id="create-route-btn" class="btn btn-success">–°–æ–∑–¥–∞—Ç—å –º–∞—Ä—à—Ä—É—Ç</button>
                    </div>
                </div>
            </div>

            <!-- –ó–∞–≥—Ä—É–∑—á–∏–∫ -->
            <div id="loader" class="loader hidden">
                <div class="spinner"></div>
                <p>–û–±—Ä–∞–±–æ—Ç–∫–∞...</p>
            </div>
        </main>
    </div>

        <script src="/socket.io/socket.io.js"></script>
        <script>
        // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è —Ä–µ–ª–∏–∑–∞
        document.addEventListener('DOMContentLoaded', async function() {
            try {
                const response = await fetch('/api/release-time');
                const data = await response.json();
                document.getElementById('release-time').textContent = `(—Ä–µ–ª–∏–∑: ${data.releaseTime})`;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ —Ä–µ–ª–∏–∑–∞:', error);
                // Fallback –Ω–∞ —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è
                const now = new Date();
                const day = String(now.getDate()).padStart(2, '0');
                const month = String(now.getMonth() + 1).padStart(2, '0');
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                const seconds = String(now.getSeconds()).padStart(2, '0');
                
                const releaseTime = `${day}.${month} ${hours}:${minutes}:${seconds}`;
                document.getElementById('release-time').textContent = `(—Ä–µ–ª–∏–∑: ${releaseTime})`;
            }
        });
    </script>
    <script src="script.js?v=24"></script>
</body>
</html> 